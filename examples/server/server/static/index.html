<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAuthn FIDO2 Test Application</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <h1>WebAuthn FIDO2 Test Application</h1>
        <p>Complete testing suite for WebAuthn authentication with simple and advanced options</p>
    </div>

    <div class="container">
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('simple')">Simple Authentication</button>
            <button class="nav-tab" onclick="switchTab('advanced')">Advanced Authentication</button>
            <button class="nav-tab" onclick="switchTab('decoder')">Decoder</button>
        </nav>

        <div class="content">
            <!-- Simple Authentication Tab -->
            <div id="simple-tab" class="tab-content active">
                <div class="section">
                    <h2>Simple Authentication</h2>
                    <p>Basic WebAuthn operations with minimal configuration - same functionality as the original demo.</p>
                    
                    <div class="status" id="simple-status"></div>

                    <div class="form-group">
                        <label for="simple-email">Username</label>
                        <div class="input-with-button">
                            <input type="text" id="simple-email" class="form-control" placeholder="Enter username">
                            <button type="button" class="btn-randomize" onclick="randomizeSimpleUsername()" title="Generate random username">ğŸ”„</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <button class="btn" onclick="simpleRegister()">Register Passkey</button>
                        <button class="btn btn-secondary" onclick="simpleAuthenticate()">Authenticate</button>
                    </div>

                    <div class="progress" id="simple-progress">
                        <div class="spinner"></div>
                        <span id="simple-progress-text">Processing...</span>
                    </div>
                </div>
            </div>

            <!-- Advanced Authentication Tab -->
            <div id="advanced-tab" class="tab-content">
                <div class="section">
                    <h2>Advanced Authentication</h2>
                    <p>Comprehensive WebAuthn configuration with full control over registration and assertion options.</p>
                    
                    <div class="status" id="advanced-status"></div>

                    <!-- Sub-tabs for Registration and Authentication -->
                    <div class="sub-tabs">
                        <button id="registration-tab-btn" class="sub-tab active" onclick="switchSubTab('registration')">Registration</button>
                        <button id="authentication-tab-btn" class="sub-tab" onclick="switchSubTab('authentication')">Authentication</button>
                    </div>

                    <div class="three-column">
                        <!-- Left Column: Registration/Authentication Form -->
                        <div class="form-column">
                            <h3>Settings</h3>
                            <!-- Registration Form -->
                            <div id="registration-form" class="sub-tab-content active">
                                <!-- User Identity Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('user-identity')">
                                    <span>User Identity</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="user-identity" class="section-content expanded">
                                    <div class="form-group">
                                        <label for="user-id">User ID (hex)</label>
                                        <div class="input-with-button">
                                            <input type="text" id="user-id" class="form-control" placeholder="Auto-generated hex value">
                                            <button class="btn btn-small refresh-icon" onclick="randomizeUserId()" title="Generate new random User ID"></button>
                                        </div>
                                        <div id="user-id-error" class="error-message">Invalid hex value (1-64 bytes required)</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="user-name">User Name</label>
                                        <input type="text" id="user-name" class="form-control" placeholder="Enter username">
                                    </div>
                                    <div class="form-group">
                                        <label for="user-display-name">Display Name</label>
                                        <input type="text" id="user-display-name" class="form-control" placeholder="Auto-generated from username" readonly style="background-color: #f8f9fa; color: #6c757d;">
                                    </div>
                                </div>
                            </div>

                            <!-- Authenticator Selection Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('authenticator-selection')">
                                    <span>Authenticator Selection</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="authenticator-selection" class="section-content">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="authenticator-attachment">Authenticator Attachment</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Select whether an authenticator integrated into the client platform ("platform") or an external device ("cross-platform") should be used.<br><br>
                                                        If unspecified (the default), either kind of authenticator is allowed.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        é€‰æ‹©æ˜¯ä½¿ç”¨é›†æˆåˆ°å®¢æˆ·ç«¯å¹³å°çš„è®¤è¯å™¨ï¼ˆ"platform"ï¼‰è¿˜æ˜¯å¤–éƒ¨è®¾å¤‡ï¼ˆ"cross-platform"ï¼‰ã€‚<br><br>
                                                        å¦‚æœæœªæŒ‡å®šï¼ˆé»˜è®¤ï¼‰ï¼Œåˆ™å…è®¸ä»»ä½•ç±»å‹çš„è®¤è¯å™¨ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="authenticator-attachment" class="form-control">
                                            <option value="">Unspecified (default)</option>
                                            <option value="cross-platform">Cross-platform</option>
                                            <option value="platform">Platform</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="resident-key">Resident Key</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        A resident key can be used for "username-less" authentication, i.e., with an empty allowCredentials parameter.<br><br>
                                                        If "discouraged", a non-resident key will be created if possible. If "preferred", a resident key will be created if possible. If "required", a resident key will be created and the user is shown an error if this fails. If unspecified, the default is "discouraged".
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        å¸¸é©»å¯†é’¥å¯ç”¨äº"æ— ç”¨æˆ·å"èº«ä»½éªŒè¯ï¼Œå³ä½¿ç”¨ç©ºçš„ allowCredentials å‚æ•°ã€‚<br><br>
                                                        å¦‚æœè®¾ä¸º"discouraged"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹å°†åˆ›å»ºéå¸¸é©»å¯†é’¥ã€‚å¦‚æœè®¾ä¸º"preferred"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹å°†åˆ›å»ºå¸¸é©»å¯†é’¥ã€‚å¦‚æœè®¾ä¸º"required"ï¼Œå°†åˆ›å»ºå¸¸é©»å¯†é’¥ï¼Œå¤±è´¥æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸º"discouraged"ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="resident-key" class="form-control">
                                            <option value="discouraged">Discouraged (default)</option>
                                            <option value="preferred">Preferred</option>
                                            <option value="required">Required</option>
                                            <option value="">Unspecified</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="user-verification-reg">User Verification</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Select whether user verification (UV), for example a PIN or biometric, should be used.<br><br>
                                                        If "discouraged", UV will not be used if possible. If "preferred", UV will be used if possible. If "required", UV will be used and the user is shown an error if this fails. If unspecified, the default is "preferred".
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        é€‰æ‹©æ˜¯å¦åº”ä½¿ç”¨ç”¨æˆ·éªŒè¯ï¼ˆUVï¼‰ï¼Œä¾‹å¦‚ PIN æˆ–ç”Ÿç‰©è¯†åˆ«ã€‚<br><br>
                                                        å¦‚æœè®¾ä¸º"discouraged"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¸ä¼šä½¿ç”¨ UVã€‚å¦‚æœè®¾ä¸º"preferred"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨ UVã€‚å¦‚æœè®¾ä¸º"required"ï¼Œä¼šä½¿ç”¨ UVï¼Œå¤±è´¥æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸º"preferred"ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="user-verification-reg" class="form-control">
                                            <option value="preferred">Preferred (default)</option>
                                            <option value="discouraged">Discouraged</option>
                                            <option value="required">Required</option>
                                            <option value="">Unspecified</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="attestation">Attestation</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Select whether the Relying Party (RP) requires authenticator attestation. Attestation is a way to prove what kind of authenticator is used.<br><br>
                                                        If "none", no authenticator attestation will be returned. If "indirect", some kind of attestation will be returned if possible, but it may be anonymized by an attestation proxy. If "direct", the authenticator's original attestation will be returned, if any. If "enterprise", the authenticator is requested to produce an individually identifying attestation. If unspecified, the default is "none".
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        é€‰æ‹©ä¾èµ–æ–¹ï¼ˆRPï¼‰æ˜¯å¦éœ€è¦è®¤è¯å™¨è¯æ˜ã€‚è¯æ˜æ˜¯ä¸€ç§è¯æ˜ä½¿ç”¨ä½•ç§è®¤è¯å™¨çš„æ–¹å¼ã€‚<br><br>
                                                        å¦‚æœé€‰æ‹©"none"ï¼Œå°†ä¸è¿”å›è®¤è¯å™¨è¯æ˜ã€‚å¦‚æœé€‰æ‹©"indirect"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¼šè¿”å›æŸç§è¯æ˜ï¼Œä½†å¯èƒ½è¢«è¯æ˜ä»£ç†åŒ¿ååŒ–ã€‚å¦‚æœé€‰æ‹©"direct"ï¼Œå°†è¿”å›è®¤è¯å™¨çš„åŸå§‹è¯æ˜ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å¦‚æœé€‰æ‹©"enterprise"ï¼Œè¯·æ±‚è®¤è¯å™¨äº§ç”Ÿä¸ªåˆ«æ ‡è¯†è¯æ˜ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸º"none"ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="attestation" class="form-control">
                                            <option value="none">None (default)</option>
                                            <option value="indirect">Indirect</option>
                                            <option value="direct">Direct</option>
                                            <option value="enterprise">Enterprise</option>
                                            <option value="">Unspecified</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>
                                                <input type="checkbox" id="exclude-credentials" checked> Exclude Credentials
                                            </label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Whether to include an excludeCredentials argument. This is used to prevent creating multiple credentials for the same account by excluding already registered credentials during registration.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        æ˜¯å¦åŒ…å« excludeCredentials å‚æ•°ã€‚è¿™ç”¨äºåœ¨æ³¨å†Œè¿‡ç¨‹ä¸­æ’é™¤å·²æ³¨å†Œçš„å‡­æ®ï¼Œé˜²æ­¢ä¸ºåŒä¸€è´¦æˆ·åˆ›å»ºå¤šä¸ªå‡­æ®ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="fake-cred-length-reg">Fake credential ID length</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Add a random credential ID of the given length to excludeCredentials. May be useful for testing edge cases and conformance.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        å‘ excludeCredentials æ·»åŠ æŒ‡å®šé•¿åº¦çš„éšæœºå‡­æ® IDã€‚å¯èƒ½å¯¹æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œä¸€è‡´æ€§æœ‰ç”¨ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="number" id="fake-cred-length-reg" class="form-control" value="128" min="1">
                                    </div>
                                </div>
                            </div>

                            <!-- Other Options Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('other-options-reg')">
                                    <span>Other Options</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="other-options-reg" class="section-content">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="challenge-reg">Challenge (hex)</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The cryptographic challenge to be signed by the authenticator, used to prevent replay attacks.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        ç”±è®¤è¯å™¨ç­¾åçš„åŠ å¯†æŒ‘æˆ˜å€¼ï¼Œç”¨äºé˜²æ­¢é‡æ”¾æ”»å‡»ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="challenge-reg" class="form-control" placeholder="Auto-generated hex value">
                                            <button class="btn btn-small refresh-icon" onclick="randomizeChallenge('reg')" title="Generate new random challenge"></button>
                                        </div>
                                        <div id="challenge-reg-error" class="error-message">Invalid hex value (minimum 16 bytes required)</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="timeout-reg">Timeout (milliseconds)</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        How long the Relying Party (RP) is willing to wait for the registration ceremony to complete. If the registration ceremony takes longer than this (or the adjusted value, in case the client overrides it), the ceremony will be aborted with a timeout message shown to the user. This may be silently overridden by the client.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        ä¾èµ–æ–¹ï¼ˆRPï¼‰æ„¿æ„ç­‰å¾…æ³¨å†Œä»ªå¼å®Œæˆçš„æ—¶é—´ã€‚å¦‚æœæ³¨å†Œä»ªå¼è¶…è¿‡æ­¤æ—¶é—´ï¼ˆæˆ–å®¢æˆ·ç«¯è¦†ç›–çš„è°ƒæ•´å€¼ï¼‰ï¼Œä»ªå¼å°†è¢«ä¸­æ­¢å¹¶å‘ç”¨æˆ·æ˜¾ç¤ºè¶…æ—¶æ¶ˆæ¯ã€‚å®¢æˆ·ç«¯å¯èƒ½ä¼šé™é»˜è¦†ç›–æ­¤è®¾ç½®ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="number" id="timeout-reg" class="form-control" value="90000" min="1">
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>Public Key Credential Parameters</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The signature algorithms supported by the Relying Party (RP). The authenticator will be choosing the most preferred algorithm that it supports. It is recommended to include at least ES256, EdDSA and RS256.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        ä¾èµ–æ–¹ï¼ˆRPï¼‰æ”¯æŒçš„ç­¾åç®—æ³•ã€‚è®¤è¯å™¨å°†é€‰æ‹©å®ƒæ”¯æŒçš„æœ€ä¼˜å…ˆç®—æ³•ã€‚å»ºè®®è‡³å°‘åŒ…æ‹¬ ES256ã€EdDSA å’Œ RS256ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="checkbox-group">
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-eddsa" checked>
                                                <label for="param-eddsa">EdDSA</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-es256" checked>
                                                <label for="param-es256">ES256</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-rs256" checked>
                                                <label for="param-rs256">RS256</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-es384">
                                                <label for="param-es384">ES384</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-es512">
                                                <label for="param-es512">ES512</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-rs384">
                                                <label for="param-rs384">RS384</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-rs512">
                                                <label for="param-rs512">RS512</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="param-rs1">
                                                <label for="param-rs1">RS1</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>Hints</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Registration hints to guide the user-agent in interacting with the user.<br><br>
                                                        Hints are suggestions that help guide the user experience. They're not required, and the system prioritizes them in order of preference. If hints conflict, the first one takes priority. Hints can also overlap, allowing for both specific and general suggestions to be sent. If hints contradict other information, the hints take precedence.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        æ³¨å†Œæç¤ºï¼Œç”¨äºæŒ‡å¯¼ç”¨æˆ·ä»£ç†ä¸ç”¨æˆ·çš„äº¤äº’ã€‚<br><br>
                                                        æç¤ºæ˜¯å¸®åŠ©æŒ‡å¯¼ç”¨æˆ·ä½“éªŒçš„å»ºè®®ã€‚å®ƒä»¬ä¸æ˜¯å¿…éœ€çš„ï¼Œç³»ç»ŸæŒ‰ä¼˜å…ˆçº§é¡ºåºå¯¹å®ƒä»¬è¿›è¡Œä¼˜å…ˆæ’åºã€‚å¦‚æœæç¤ºå†²çªï¼Œç¬¬ä¸€ä¸ªä¼˜å…ˆã€‚æç¤ºä¹Ÿå¯ä»¥é‡å ï¼Œå…è®¸å‘é€ç‰¹å®šå’Œä¸€èˆ¬å»ºè®®ã€‚å¦‚æœæç¤ºä¸å…¶ä»–ä¿¡æ¯çŸ›ç›¾ï¼Œæç¤ºä¼˜å…ˆã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="checkbox-group">
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-client-device">
                                                <label for="hint-client-device">Client-device</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-hybrid">
                                                <label for="hint-hybrid">Hybrid</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-security-key">
                                                <label for="hint-security-key">Security-key</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Extensions Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('extensions-reg')">
                                    <span>Extensions</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="extensions-reg" class="section-content">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>
                                                <input type="checkbox" id="cred-props" checked> credProps
                                            </label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Credential Properties (credProps) extension. This extension may report properties such as whether a discoverable or non-discoverable credential was created.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚å‡­æ®å±æ€§ï¼ˆcredPropsï¼‰æ‰©å±•ã€‚æ­¤æ‰©å±•å¯èƒ½æŠ¥å‘Šå±æ€§ï¼Œä¾‹å¦‚æ˜¯å¦åˆ›å»ºäº†å¯å‘ç°æˆ–ä¸å¯å‘ç°çš„å‡­æ®ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>
                                                <input type="checkbox" id="min-pin-length"> minPinLength
                                            </label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Minimum PIN Length Extension (minPinLength). This extension may report the authenticator's currently configured minimum PIN length if the Relying Party (RP) is authorized to receive this value.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚æœ€å° PIN é•¿åº¦æ‰©å±•ï¼ˆminPinLengthï¼‰ã€‚å¦‚æœä¾èµ–æ–¹ï¼ˆRPï¼‰è¢«æˆæƒæ¥æ”¶æ­¤å€¼ï¼Œæ­¤æ‰©å±•å¯èƒ½æŠ¥å‘Šè®¤è¯å™¨å½“å‰é…ç½®çš„æœ€å° PIN é•¿åº¦ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="cred-protect">credProtect</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Credential protection (credProtect) extension. This extension sets whether the authenticator requires user verification (UV) before revealing the existence of a credential. If it does, that also means that the authenticator requires UV before allowing authentication using that credential.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚å‡­æ®ä¿æŠ¤ï¼ˆcredProtectï¼‰æ‰©å±•ã€‚æ­¤æ‰©å±•è®¾ç½®è®¤è¯å™¨åœ¨æ˜¾ç¤ºå‡­æ®å­˜åœ¨ä¹‹å‰æ˜¯å¦éœ€è¦ç”¨æˆ·éªŒè¯ï¼ˆUVï¼‰ã€‚å¦‚æœéœ€è¦ï¼Œè¿™ä¹Ÿæ„å‘³ç€è®¤è¯å™¨åœ¨å…è®¸ä½¿ç”¨è¯¥å‡­æ®è¿›è¡Œèº«ä»½éªŒè¯ä¹‹å‰éœ€è¦ UVã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="cred-protect" class="form-control">
                                            <option value="">Unspecified (default)</option>
                                            <option value="userVerificationOptional">userVerificationOptional</option>
                                            <option value="userVerificationOptionalWithCredentialIdList">userVerificationOptionalWithCredentialIdList</option>
                                            <option value="userVerificationRequired">userVerificationRequired</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>
                                                <input type="checkbox" id="enforce-cred-protect" checked disabled> Enforce credProtect
                                            </label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Whether to enforce the selected credProtect policy, if any, meaning the registration should fail rather than create a credential that does not satisfy the credProtect policy.<br><br>
                                                        If this is checked and credProtect is set to userVerificationOptionalWithCredentialIDList or userVerificationRequired, and the authenticator cannot satisfy that policy, then the registration will fail. If this is not checked, the registration MAY proceed even if the authenticator cannot satisfy the chosen policy.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæ‰€é€‰çš„ credProtect ç­–ç•¥ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œæ„å‘³ç€æ³¨å†Œåº”è¯¥å¤±è´¥è€Œä¸æ˜¯åˆ›å»ºä¸æ»¡è¶³ credProtect ç­–ç•¥çš„å‡­æ®ã€‚<br><br>
                                                        å¦‚æœé€‰ä¸­æ­¤é¡¹ä¸” credProtect è®¾ç½®ä¸º userVerificationOptionalWithCredentialIDList æˆ– userVerificationRequiredï¼Œå¹¶ä¸”è®¤è¯å™¨æ— æ³•æ»¡è¶³è¯¥ç­–ç•¥ï¼Œåˆ™æ³¨å†Œå°†å¤±è´¥ã€‚å¦‚æœæœªé€‰ä¸­ï¼Œå³ä½¿è®¤è¯å™¨æ— æ³•æ»¡è¶³æ‰€é€‰ç­–ç•¥ï¼Œæ³¨å†Œä¹Ÿå¯èƒ½ç»§ç»­ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="large-blob-reg">largeBlob</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Large blob storage (largeBlob) extension. This extension may be used to store arbitrary data with the credential.<br><br>
                                                        If the authenticator supports the extension, an extension output of largeBlob: { supported: true } will be returned. Use the largeBlob extension during an authentication ceremony to read or write the BLOB value.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚å¤§å‹ blob å­˜å‚¨ï¼ˆlargeBlobï¼‰æ‰©å±•ã€‚æ­¤æ‰©å±•å¯ç”¨äºåœ¨å‡­æ®ä¸­å­˜å‚¨ä»»æ„æ•°æ®ã€‚<br><br>
                                                        å¦‚æœè®¤è¯å™¨æ”¯æŒæ­¤æ‰©å±•ï¼Œå°†è¿”å› largeBlob: { supported: true } çš„æ‰©å±•è¾“å‡ºã€‚åœ¨èº«ä»½éªŒè¯ä»ªå¼æœŸé—´ä½¿ç”¨ largeBlob æ‰©å±•æ¥è¯»å–æˆ–å†™å…¥ BLOB å€¼ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="large-blob-reg" class="form-control">
                                            <option value="">Unspecified (default)</option>
                                            <option value="preferred">Preferred</option>
                                            <option value="required">Required</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>
                                                <input type="checkbox" id="prf-reg" checked> prf
                                            </label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Pseudo-random function (prf) extension. This extension may be used to derive deterministically-random values to use as key material, for example.<br><br>
                                                        With CTAP authenticators, this requires that the authenticator supports the hmac-secret extension.<br><br>
                                                        Many authenticators support evaluating the PRF only in authentication ceremonies, in which case the PRF extension output is just prf: { enabled: true } without any PRF outputs. To evaluate the PRF, perform an authentication ceremony with the same PRF inputs.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚ä¼ªéšæœºå‡½æ•°ï¼ˆprfï¼‰æ‰©å±•ã€‚ä¾‹å¦‚ï¼Œæ­¤æ‰©å±•å¯ç”¨äºæ´¾ç”Ÿç¡®å®šæ€§éšæœºå€¼ä½œä¸ºå¯†é’¥ææ–™ã€‚<br><br>
                                                        å¯¹äº CTAP è®¤è¯å™¨ï¼Œè¿™è¦æ±‚è®¤è¯å™¨æ”¯æŒ hmac-secret æ‰©å±•ã€‚<br><br>
                                                        è®¸å¤šè®¤è¯å™¨ä»…æ”¯æŒåœ¨èº«ä»½éªŒè¯ä»ªå¼ä¸­è¯„ä¼° PRFï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒPRF æ‰©å±•è¾“å‡ºåªæ˜¯ prf: { enabled: true }ï¼Œæ²¡æœ‰ä»»ä½• PRF è¾“å‡ºã€‚è¦è¯„ä¼° PRFï¼Œè¯·ä½¿ç”¨ç›¸åŒçš„ PRF è¾“å…¥æ‰§è¡Œèº«ä»½éªŒè¯ä»ªå¼ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="prf-eval-first-reg">prf eval first</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The first prf extension input to evaluate. If set, the client extension outputs will include a prf.results.first output if the client and authenticator both support the extension.<br><br>
                                                        Many authenticators support evaluating the PRF only in authentication ceremonies, in which case the PRF extension output is just prf: { enabled: true } without any PRF outputs. To evaluate the PRF, perform an authentication ceremony with the same PRF inputs.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¦è¯„ä¼°çš„ç¬¬ä¸€ä¸ª prf æ‰©å±•è¾“å…¥ã€‚å¦‚æœè®¾ç½®ï¼Œå¦‚æœå®¢æˆ·ç«¯å’Œè®¤è¯å™¨éƒ½æ”¯æŒè¯¥æ‰©å±•ï¼Œå®¢æˆ·ç«¯æ‰©å±•è¾“å‡ºå°†åŒ…å« prf.results.first è¾“å‡ºã€‚<br><br>
                                                        è®¸å¤šè®¤è¯å™¨ä»…æ”¯æŒåœ¨èº«ä»½éªŒè¯ä»ªå¼ä¸­è¯„ä¼° PRFï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒPRF æ‰©å±•è¾“å‡ºåªæ˜¯ prf: { enabled: true }ï¼Œæ²¡æœ‰ä»»ä½• PRF è¾“å‡ºã€‚è¦è¯„ä¼° PRFï¼Œè¯·ä½¿ç”¨ç›¸åŒçš„ PRF è¾“å…¥æ‰§è¡Œèº«ä»½éªŒè¯ä»ªå¼ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="prf-eval-first-reg" class="form-control" placeholder="Hex value">
                                            <button class="btn btn-small refresh-icon" onclick="randomizePrfEval('first', 'reg')" title="Generate random PRF evaluation data"></button>
                                        </div>
                                        <div id="prf-eval-first-reg-error" class="error-message">Invalid hex value (exactly 32 bytes required)</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="prf-eval-second-reg">prf eval second</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The second prf extension input to evaluate. If set, the client extension outputs will include a prf.results.second output if the client and authenticator both support the extension.<br><br>
                                                        This is optional and can be used alongside the first PRF evaluation input for additional key derivation capabilities.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¦è¯„ä¼°çš„ç¬¬äºŒä¸ª prf æ‰©å±•è¾“å…¥ã€‚å¦‚æœè®¾ç½®ï¼Œå¦‚æœå®¢æˆ·ç«¯å’Œè®¤è¯å™¨éƒ½æ”¯æŒè¯¥æ‰©å±•ï¼Œå®¢æˆ·ç«¯æ‰©å±•è¾“å‡ºå°†åŒ…å« prf.results.second è¾“å‡ºã€‚<br><br>
                                                        è¿™æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥ä¸ç¬¬ä¸€ä¸ª PRF è¯„ä¼°è¾“å…¥ä¸€èµ·ä½¿ç”¨ï¼Œä»¥è·å¾—é¢å¤–çš„å¯†é’¥æ´¾ç”ŸåŠŸèƒ½ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="prf-eval-second-reg" class="form-control" placeholder="Hex value" disabled>
                                            <button class="btn btn-small refresh-icon" onclick="randomizePrfEval('second', 'reg')" disabled title="Generate random PRF evaluation data"></button>
                                        </div>
                                        <div id="prf-eval-second-reg-error" class="error-message">Invalid hex value (exactly 32 bytes required)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 2rem;">
                                <button class="btn" onclick="advancedRegister()">Create Credential</button>
                                <button class="btn btn-secondary" onclick="resetRegistrationForm()">Reset</button>
                            </div>
                        </div>

                            <!-- Authentication Form -->
                            <div id="authentication-form" class="sub-tab-content">
                            <!-- Credential Selection Section -->
                            <div class="expandable-section">
                                <div class="section-header expanded" onclick="toggleSection('credential-selection')">
                                    <span>Credential Selection</span>
                                    <span class="expand-icon rotated">â–¼</span>
                                </div>
                                <div id="credential-selection" class="section-content expanded">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="user-verification-auth">User Verification</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Select whether user verification (UV), for example a PIN or biometric, should be used.<br><br>
                                                        If "discouraged", UV will not be used if possible. If "preferred", UV will be used if possible. If "required", UV will be used and the user is shown an error if this fails. If unspecified, the default is "preferred".
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        é€‰æ‹©æ˜¯å¦åº”ä½¿ç”¨ç”¨æˆ·éªŒè¯ï¼ˆUVï¼‰ï¼Œä¾‹å¦‚ PIN æˆ–ç”Ÿç‰©è¯†åˆ«ã€‚<br><br>
                                                        å¦‚æœè®¾ä¸º"discouraged"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¸ä¼šä½¿ç”¨ UVã€‚å¦‚æœè®¾ä¸º"preferred"ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨ UVã€‚å¦‚æœè®¾ä¸º"required"ï¼Œå°†ä½¿ç”¨ UVï¼Œå¤±è´¥æ—¶å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯ã€‚å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸º"preferred"ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="user-verification-auth" class="form-control">
                                            <option value="preferred">Preferred (default)</option>
                                            <option value="discouraged">Discouraged</option>
                                            <option value="required">Required</option>
                                            <option value="">Unspecified</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="allow-credentials">Allow Credentials</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Choose how to set the allowCredentials argument. This is used to select which credentials are eligible for this assertion, and to provide key handles for server-side credentials. This typically means that the user needs to be identified before issuing the WebAuthn challenge, so that the Relying Party (RP) can retrieve the correct allowCredentials values.<br><br>
                                                        Select "All" to include all credentials registered in the session (see the pane on the right).<br><br>
                                                        Select "Empty" to remove the allowCredentials argument. This means that only discoverable credentials can be used for the assertion.<br><br>
                                                        Select a saved credential option to include only the specific chosen credential.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        é€‰æ‹©å¦‚ä½•è®¾ç½® allowCredentials å‚æ•°ã€‚è¿™ç”¨äºé€‰æ‹©å“ªäº›å‡­æ®ç¬¦åˆæ­¤æ–­è¨€æ¡ä»¶ï¼Œå¹¶ä¸ºæœåŠ¡å™¨ç«¯å‡­æ®æä¾›å¯†é’¥å¥æŸ„ã€‚è¿™é€šå¸¸æ„å‘³ç€åœ¨å‘å‡º WebAuthn æŒ‘æˆ˜ä¹‹å‰éœ€è¦è¯†åˆ«ç”¨æˆ·ï¼Œä»¥ä¾¿ä¾èµ–æ–¹ï¼ˆRPï¼‰å¯ä»¥æ£€ç´¢æ­£ç¡®çš„ allowCredentials å€¼ã€‚<br><br>
                                                        é€‰æ‹©"All"ä»¥åŒ…å«ä¼šè¯ä¸­æ³¨å†Œçš„æ‰€æœ‰å‡­æ®ï¼ˆè¯·å‚è§å³ä¾§çª—æ ¼ï¼‰ã€‚<br><br>
                                                        é€‰æ‹©"Empty"ä»¥åˆ é™¤ allowCredentials å‚æ•°ã€‚è¿™æ„å‘³ç€åªæœ‰å¯å‘ç°çš„å‡­æ®å¯ç”¨äºæ–­è¨€ã€‚<br><br>
                                                        é€‰æ‹©ä¿å­˜çš„å‡­æ®é€‰é¡¹ä»¥ä»…åŒ…å«ç‰¹å®šé€‰æ‹©çš„å‡­æ®ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="allow-credentials" class="form-control">
                                            <option value="all">All credentials</option>
                                            <option value="empty">Empty (resident key only)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="fake-cred-length-auth">Fake credential ID length</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Add a random credential ID of the given length to allowCredentials. May be useful for testing edge cases and conformance.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        å‘ allowCredentials æ·»åŠ ç»™å®šé•¿åº¦çš„éšæœºå‡­æ® IDã€‚å¯èƒ½å¯¹æµ‹è¯•è¾¹ç¼˜æƒ…å†µå’Œåˆè§„æ€§æœ‰ç”¨ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="number" id="fake-cred-length-auth" class="form-control" value="256" min="1">
                                    </div>
                                </div>
                            </div>

                            <!-- Other Options Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('other-options-auth')">
                                    <span>Other Options</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="other-options-auth" class="section-content">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="challenge-auth">Challenge (hex)</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The cryptographic challenge to be signed by the authenticator, used to prevent replay attacks.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¦ç”±è®¤è¯å™¨ç­¾åçš„åŠ å¯†æŒ‘æˆ˜ï¼Œç”¨äºé˜²æ­¢é‡æ”¾æ”»å‡»ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="challenge-auth" class="form-control" placeholder="Auto-generated hex value">
                                            <button class="btn btn-small refresh-icon" onclick="randomizeChallenge('auth')" title="Generate new random challenge"></button>
                                        </div>
                                        <div id="challenge-auth-error" class="error-message">Invalid hex value (minimum 16 bytes required)</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="timeout-auth">Timeout (milliseconds)</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        How long the Relying Party (RP) is willing to wait for the authentication ceremony to complete. If the authentication ceremony takes longer than this (or the adjusted value, in case the client overrides it), the ceremony will be aborted with a timeout message shown to the user. This may be silently overridden by the client.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        ä¾èµ–æ–¹ï¼ˆRPï¼‰æ„¿æ„ç­‰å¾…èº«ä»½éªŒè¯ä»ªå¼å®Œæˆçš„æ—¶é—´ã€‚å¦‚æœèº«ä»½éªŒè¯ä»ªå¼æ—¶é—´è¶…è¿‡æ­¤å€¼ï¼ˆæˆ–è°ƒæ•´åçš„å€¼ï¼Œå¦‚æœå®¢æˆ·ç«¯è¦†ç›–ï¼‰ï¼Œä»ªå¼å°†è¢«ä¸­æ­¢ï¼Œå¹¶å‘ç”¨æˆ·æ˜¾ç¤ºè¶…æ—¶æ¶ˆæ¯ã€‚è¿™å¯èƒ½ä¼šè¢«å®¢æˆ·ç«¯é™é»˜è¦†ç›–ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="number" id="timeout-auth" class="form-control" value="90000" min="1">
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label>Hints</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Authentication hints to guide the user-agent in interacting with the user.<br><br>
                                                        Hints are suggestions that help guide the user experience. They're not required, and the system prioritizes them in order of preference. If hints conflict, the first one takes priority. Hints can also overlap, allowing for both specific and general suggestions to be sent. If hints contradict other information, the hints take precedence.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        èº«ä»½éªŒè¯æç¤ºï¼Œç”¨äºæŒ‡å¯¼ç”¨æˆ·ä»£ç†ä¸ç”¨æˆ·çš„äº¤äº’ã€‚<br><br>
                                                        æç¤ºæ˜¯å¸®åŠ©æŒ‡å¯¼ç”¨æˆ·ä½“éªŒçš„å»ºè®®ã€‚å®ƒä»¬ä¸æ˜¯å¿…éœ€çš„ï¼Œç³»ç»ŸæŒ‰ä¼˜å…ˆçº§é¡ºåºå¯¹å®ƒä»¬è¿›è¡Œä¼˜å…ˆæ’åºã€‚å¦‚æœæç¤ºå†²çªï¼Œç¬¬ä¸€ä¸ªä¼˜å…ˆã€‚æç¤ºä¹Ÿå¯ä»¥é‡å ï¼Œå…è®¸å‘é€ç‰¹å®šå’Œä¸€èˆ¬å»ºè®®ã€‚å¦‚æœæç¤ºä¸å…¶ä»–ä¿¡æ¯çŸ›ç›¾ï¼Œæç¤ºä¼˜å…ˆã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="checkbox-group">
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-client-device-auth">
                                                <label for="hint-client-device-auth">Client-device</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-hybrid-auth">
                                                <label for="hint-hybrid-auth">Hybrid</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="hint-security-key-auth">
                                                <label for="hint-security-key-auth">Security-key</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Extensions Section -->
                            <div class="expandable-section">
                                <div class="section-header" onclick="toggleSection('extensions-auth')">
                                    <span>Extensions</span>
                                    <span class="expand-icon">â–¼</span>
                                </div>
                                <div id="extensions-auth" class="section-content">
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="large-blob-auth">largeBlob</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Large blob storage (largeBlob) extension. This extension may be used to store arbitrary data with the credential.<br><br>
                                                        If set to "read", the output will be of the form largeBlob: { blob: ArrayBuffer } if both client and authenticator support the extension and the authenticator contains a matching BLOB value. Otherwise the output will be largeBlob: {} if the client supports the extension.<br><br>
                                                        If set to "write", the output will be largeBlob: { written: true } if the BLOB was successfully written to the authenticator, and otherwise largeBlob: { written: false } if the client supports the extension.<br><br>
                                                        If the client does not support the extension, no largeBlob output will be present.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚å¤§å‹ blob å­˜å‚¨ï¼ˆlargeBlobï¼‰æ‰©å±•ã€‚æ­¤æ‰©å±•å¯ç”¨äºä¸å‡­æ®ä¸€èµ·å­˜å‚¨ä»»æ„æ•°æ®ã€‚<br><br>
                                                        å¦‚æœè®¾ç½®ä¸º"read"ï¼Œå¦‚æœå®¢æˆ·ç«¯å’Œè®¤è¯å™¨éƒ½æ”¯æŒè¯¥æ‰©å±•ä¸”è®¤è¯å™¨åŒ…å«åŒ¹é…çš„ BLOB å€¼ï¼Œè¾“å‡ºå°†ä¸º largeBlob: { blob: ArrayBuffer }ã€‚å¦åˆ™ï¼Œå¦‚æœå®¢æˆ·ç«¯æ”¯æŒè¯¥æ‰©å±•ï¼Œè¾“å‡ºå°†ä¸º largeBlob: {}ã€‚<br><br>
                                                        å¦‚æœè®¾ç½®ä¸º"write"ï¼Œå¦‚æœ BLOB æˆåŠŸå†™å…¥è®¤è¯å™¨ï¼Œè¾“å‡ºå°†ä¸º largeBlob: { written: true }ï¼Œå¦åˆ™å¦‚æœå®¢æˆ·ç«¯æ”¯æŒè¯¥æ‰©å±•ï¼Œå°†ä¸º largeBlob: { written: false }ã€‚<br><br>
                                                        å¦‚æœå®¢æˆ·ç«¯ä¸æ”¯æŒè¯¥æ‰©å±•ï¼Œå°†ä¸å­˜åœ¨ largeBlob è¾“å‡ºã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="large-blob-auth" class="form-control">
                                            <option value="">Unspecified (default)</option>
                                            <option value="read">Read</option>
                                            <option value="write">Write</option>
                                        </select>
                                        <div id="large-blob-capability-message" class="error-message" style="color: #6c757d; display: none;">No largeBlob capable credentials available</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="large-blob-write">largeBlob write</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The BLOB value to write to the authenticator.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¦å†™å…¥è®¤è¯å™¨çš„ BLOB å€¼ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="large-blob-write" class="form-control" placeholder="Hex value" disabled>
                                            <button class="btn btn-small refresh-icon" onclick="randomizeLargeBlobWrite()" disabled title="Generate random large blob data"></button>
                                        </div>
                                        <div id="large-blob-write-error" class="error-message">Invalid hex value</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="prf-eval-first-auth">prf eval first</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        Request the Pseudo-random function (prf) extension and set the first prf extension input to evaluate. This extension may be used to derive deterministically-random values to use as key material, for example.<br><br>
                                                        If set, the client extension outputs will include a prf.results.first output if the client and authenticator both support the extension.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¯·æ±‚ä¼ªéšæœºå‡½æ•°ï¼ˆprfï¼‰æ‰©å±•å¹¶è®¾ç½®è¦è¯„ä¼°çš„ç¬¬ä¸€ä¸ª prf æ‰©å±•è¾“å…¥ã€‚ä¾‹å¦‚ï¼Œæ­¤æ‰©å±•å¯ç”¨äºæ´¾ç”Ÿç¡®å®šæ€§éšæœºå€¼ä½œä¸ºå¯†é’¥ææ–™ã€‚<br><br>
                                                        å¦‚æœè®¾ç½®ï¼Œå¦‚æœå®¢æˆ·ç«¯å’Œè®¤è¯å™¨éƒ½æ”¯æŒè¯¥æ‰©å±•ï¼Œå®¢æˆ·ç«¯æ‰©å±•è¾“å‡ºå°†åŒ…å« prf.results.first è¾“å‡ºã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="prf-eval-first-auth" class="form-control" placeholder="Hex value">
                                            <button class="btn btn-small refresh-icon" onclick="randomizePrfEval('first', 'auth')" title="Generate random PRF evaluation data"></button>
                                        </div>
                                        <div id="prf-eval-first-auth-error" class="error-message">Invalid hex value (exactly 32 bytes required)</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="label-with-info">
                                            <label for="prf-eval-second-auth">prf eval second</label>
                                            <div class="info-icon" onmouseenter="showInfoPopup(this)" onmouseleave="hideInfoPopup(this)">
                                                <div class="info-popup">
                                                    <div class="language-toggle" onclick="toggleLanguage(this)">ENG</div>
                                                    <div class="text-en active">
                                                        The second prf extension input to evaluate. If set, the client extension outputs will include a prf.results.second output if the client and authenticator both support the extension.<br><br>
                                                        A second output may be useful to rotate key material via a single WebAuthn ceremony.
                                                    </div>
                                                    <div class="text-zh hidden">
                                                        è¦è¯„ä¼°çš„ç¬¬äºŒä¸ª prf æ‰©å±•è¾“å…¥ã€‚å¦‚æœè®¾ç½®ï¼Œå¦‚æœå®¢æˆ·ç«¯å’Œè®¤è¯å™¨éƒ½æ”¯æŒè¯¥æ‰©å±•ï¼Œå®¢æˆ·ç«¯æ‰©å±•è¾“å‡ºå°†åŒ…å« prf.results.second è¾“å‡ºã€‚<br><br>
                                                        ç¬¬äºŒä¸ªè¾“å‡ºå¯èƒ½æœ‰åŠ©äºé€šè¿‡å•ä¸ª WebAuthn ä»ªå¼è½®æ¢å¯†é’¥ææ–™ã€‚
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="input-with-button">
                                            <input type="text" id="prf-eval-second-auth" class="form-control" placeholder="Hex value" disabled>
                                            <button class="btn btn-small refresh-icon" onclick="randomizePrfEval('second', 'auth')" disabled title="Generate random PRF evaluation data"></button>
                                        </div>
                                        <div id="prf-eval-second-auth-error" class="error-message">Invalid hex value (exactly 32 bytes required)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 2rem;">
                                <button class="btn" onclick="advancedAuthenticate()">Assert Credential</button>
                                <button class="btn btn-secondary" onclick="resetAuthenticationForm()">Reset</button>
                            </div>
                        </div>
                        </div>

                        <!-- Middle Column: JSON Editor -->
                        <div class="json-editor-column">
                            <h3>JSON Editor</h3>
                            <div id="json-editor-container" class="json-editor">
                                <textarea id="json-editor" placeholder="JSON representation will appear here automatically..."></textarea>
                            </div>
                            <div class="json-editor-buttons" style="margin-top: 0.5rem;">
                                <button class="btn" onclick="saveJsonEditor()" title="Save JSON changes to settings">Save</button>
                                <button class="btn btn-secondary" onclick="resetJsonEditor()" title="Reset JSON to match current settings">Reset</button>
                            </div>
                        </div>

                        <!-- Right Column: Credentials Panel -->
                        <div class="credentials-column">
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="binary-format">Binary Format</label>
                                <select id="binary-format" class="form-control" onchange="changeBinaryFormat()">
                                    <option value="hex">hex</option>
                                    <option value="b64">b64</option>
                                    <option value="b64u">b64u</option>
                                    <option value="js">js</option>
                                </select>
                            </div>
                            <h3>Saved Credentials</h3>
                            <div class="credentials-panel">
                                <div id="credentials-list">
                                    <p style="color: #6c757d; font-style: italic;">No credentials registered yet.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="progress" id="advanced-progress">
                        <div class="spinner"></div>
                        <span id="advanced-progress-text">Processing...</span>
                    </div>
            </div>

            <!-- Decoder Tab -->
            <div id="decoder-tab" class="tab-content">
                <div class="section">
                    <h2>WebAuthn Response Decoder</h2>
                    <p>Decode and analyze WebAuthn authentication responses, credential data, and attestation objects.</p>
                    
                    <div class="status" id="decoder-status"></div>

                    <div class="form-group">
                        <label for="decoder-input">Paste WebAuthn Response JSON</label>
                        <textarea id="decoder-input" class="form-control" rows="10" placeholder="Paste your WebAuthn registration or authentication response here..."></textarea>
                    </div>

                    <div class="form-group">
                        <button class="btn" onclick="decodeResponse()">Decode Response</button>
                        <button class="btn btn-secondary" onclick="clearDecoder()">Clear</button>
                    </div>

                    <div id="decoder-output" style="display: none;">
                        <h3>Decoded Information</h3>
                        <div id="decoded-content" class="json-editor">
                            <!-- Decoded output will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Credential Details Modal -->
    <div id="credentialModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Credential Details</h2>
                <button class="modal-close" onclick="closeCredentialModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </div>
    <script type="module" src="script.js"></script>
</body>
</html>