<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAuthn FIDO2 Test Application</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='mds.css') }}">
</head>
<body>
{% include 'index/header.html' %}

    <div class="container">
{% include 'index/navigation.html' %}

        <div class="content">
{% include 'index/tabs/simple.html' %}

{% include 'index/tabs/advanced.html' %}

{% include 'index/tabs/decoder.html' %}

{% include 'index/tabs/mds.html' %}
        </div>
    </div>

{% include 'index/modals/registration-result.html' %}

{% include 'index/modals/credential-details.html' %}

    <div id="json-editor-overlay" class="json-editor-overlay"></div>
    <script id="initial-mds-bootstrap" type="application/json">
        {{ {"jws": initial_mds_blob, "info": initial_mds_info} | tojson | safe }}
    </script>
    <script>
        (function () {
            const bootstrapEl = document.getElementById('initial-mds-bootstrap');

            if (!bootstrapEl) {
                return;
            }

            const rawPayload = bootstrapEl.textContent ? bootstrapEl.textContent.trim() : '';
            let payload = null;

            if (rawPayload) {
                try {
                    payload = JSON.parse(rawPayload);
                } catch (error) {
                    console.error('Failed to parse initial MDS bootstrap payload.', error);
                }
            }

            if (payload && typeof payload === 'object') {
                if (typeof payload.jws === 'string') {
                    window.__INITIAL_MDS_JWS__ = payload.jws;
                }

                if (payload.info && typeof payload.info === 'object') {
                    window.__INITIAL_MDS_INFO__ = payload.info;
                }
            }
        })();
    </script>
    <script type="module" src="{{ url_for('static', filename='mds.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
